{% extends 'base.html' %}

{% block title %}Share {{ device.name }} - Device Sharing{% endblock %}

{% block content %}
<div class="auth-container">
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    <div class="auth-card" style="max-width: 500px;">
        <div class="auth-header">
            <h1 class="auth-title">Share Device</h1>
            <p class="auth-subtitle">{{ device.name }} in {{ device.group.name }}</p>
        </div>
        
        <form method="post" class="auth-form">
            {% csrf_token %}
            
            <div class="form-group">
                <select name="user_id" 
                        id="user_id" 
                        class="form-input" 
                        required>
                    <option value="">Select a user...</option>
                    {% for member in group_members %}
                        <option value="{{ member.id }}">{{ member.username }}{% if member.email %} ({{ member.email }}){% endif %}</option>
                    {% endfor %}
                </select>
                <label for="user_id" class="form-label select-label">Group Member</label>
            </div>
            
            <div class="form-group">
                <select name="permission_level" 
                        id="permission_level" 
                        class="form-input" 
                        required>
                    <option value="">Select permission level...</option>
                    <option value="reader">Reader - View device status only</option>
                    <option value="admin">Admin - Full control of device</option>
                </select>
                <label for="permission_level" class="form-label select-label">Permission Level</label>
            </div>
            
            <div class="permission-info">
                <h4>Permission Levels:</h4>
                <ul>
                    <li><strong>Reader:</strong> Can view device status and information, but cannot control the device</li>
                    <li><strong>Admin:</strong> Full control - can view, control, and manage device settings</li>
                </ul>
            </div>
            
            <button type="submit" class="btn-primary">Grant Access</button>
        </form>
        
        <div class="auth-footer">
            <p><a href="{% url 'iot:device_detail' device.id %}" class="link">‚Üê Back to {{ device.name }}</a></p>
        </div>
    </div>
</div>

<style>
.permission-info {
    background: #f8f9fa;
    border: 1px solid #dadce0;
    border-radius: 4px;
    padding: 16px;
    margin: 16px 0;
}

.permission-info h4 {
    margin: 0 0 8px 0;
    color: #202124;
    font-size: 14px;
}

.permission-info ul {
    margin: 0;
    padding-left: 20px;
}

.permission-info li {
    margin-bottom: 4px;
    font-size: 14px;
    color: #5f6368;
    line-height: 1.4;
}

.select-label {
    background: white;
    padding: 0 4px;
}

select.form-input {
    color: #202124;
}

select.form-input:focus + .select-label,
select.form-input:not([value=""]) + .select-label {
    transform: translateY(-14px) scale(0.75);
    color: #1a73e8;
    background-color: #fff;
    padding: 0 4px;
}
</style>
{% endblock %}